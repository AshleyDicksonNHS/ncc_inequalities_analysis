[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Neonatal Critical Care Base Dataset: Construction and Descriptive Statistics",
    "section": "",
    "text": "This report documents the construction of the base dataset for analysing inequalities in Neonatal Critical Care (NCC) access in England. The dataset links maternity services data (MSDS) with critical care data to create a comprehensive birth-level dataset for hierarchical modelling.\nKey findings:\n\nFinal dataset: 512,032 births in financial year 2023/24\nNCC admission rate: 12.5% (64,109 babies)\nCritical data quality issue identified and resolved: MSDS tables contained 2-10x duplication due to multiple submissions\nData source selection: Critical Care (CC) data preferred over MSDS for NCC admissions due to contractual reporting requirements and better data quality\n\n\n\nThis analysis looks at which babies receive specialist neonatal critical care in England. We found that approximately 1 in 8 babies (12.5%) born in hospital require some form of neonatal critical care.\nThe data we’ve assembled will help us understand whether all babies have equal access to this care, regardless of their:\n\nEthnic background\nFamily’s socioeconomic circumstances\nWhere they live in England\nTheir mother’s social circumstances\n\nUnderstanding these patterns is the first step toward ensuring every baby gets the care they need, when they need it."
  },
  {
    "objectID": "index.html#data-sources",
    "href": "index.html#data-sources",
    "title": "Neonatal Critical Care Base Dataset: Construction and Descriptive Statistics",
    "section": "2.1 Data Sources",
    "text": "2.1 Data Sources\n\n2.1.1 Primary Data Sources\n\nMSDS (Maternity Services Dataset) - NHS Digital national maternity data:\n\nMSD401BabyDemographics_1: Birth details and baby demographics\nMSD301LabourDelivery_1: Labour and delivery information\nMSD101PregnancyBooking_1: Pregnancy booking and social factors\nMSD001MotherDemog_1: Mother demographics\nMSD402NeonatalAdmission_1: MSDS-reported neonatal admissions\n\nCritical Care (Pbr_CC_Monthly) - Daily-level critical care records:\n\nFiltered by CC_Type = 'NCC' for neonatal critical care\nContains care levels, length of stay, and clinical details\nUsed for Payment by Results (contractual requirement)\n\nAPCS (Admitted Patient Care Spells) - APCS_Core_Daily:\n\nProvides NHS Numbers for linkage between MSDS and CC data\nEssential linkage table\n\n\n\n\n2.1.2 Data Linkage Strategy\n\nStart with MSDS births (MSD401BabyDemographics_1) as base\nLink MSDS tables via Labour_Delivery_ID, UniqPregID, Person_ID_Mother\nLink to CC data via NHS_Number (pseudonymized) through APCS\nApply 90-day date proximity filter when linking births to CC admissions\nCompare NCC admission status from both MSDS and CC sources\n\n\n\n2.1.3 Time Period\n\nFinancial Year: 2023/24 (April 1, 2023 - March 31, 2024)\nDatabase: UDAL_Warehouse on Azure Synapse Analytics"
  },
  {
    "objectID": "index.html#critical-data-quality-issue-duplication",
    "href": "index.html#critical-data-quality-issue-duplication",
    "title": "Neonatal Critical Care Base Dataset: Construction and Descriptive Statistics",
    "section": "2.2 Critical Data Quality Issue: Duplication",
    "text": "2.2 Critical Data Quality Issue: Duplication\n\n2.2.1 Problem Identified\nInitial analysis revealed massive duplication in all MSDS tables due to multiple submissions:\n\n\n\nTable 1: Duplication Statistics in MSDS Tables\n\n\nTable\nRaw Records\nUnique IDs\nDuplication Factor\nNatural Key\n\n\n\n\nMSD401 (Baby Demographics)\n1,838,436\n541,276\n3.4x\nPerson_ID_Baby\n\n\nMSD301 (Labour/Delivery)\n1,817,611\n501,767\n3.6x\nLabourDeliveryID\n\n\nMSD101 (Pregnancy/Booking)\n8,080,487\n798,854\n10.1x\nUniqPregID\n\n\nMSD402 (Neonatal Admissions)\n107,089\n51,126\n2.1x\nPerson_ID_Baby + Transfer Date/Time\n\n\nMSD001 (Mother Demographics)\n41,462,657 (all time)\n4,155,888\n~10x\nPerson_ID_Mother\n\n\n\n\n\nWithout deduplication, the final dataset would have contained ~1.8 million records instead of the expected ~540,000 births.\n\n\n2.2.2 Root Cause Analysis\nInvestigation of duplicate records revealed:\n\n495,826 babies (91.6%) had duplicate records in MSD401\n50.3% had exactly 2 records, 17.9% had exactly 4 records\nSome babies had up to 32 duplicate records\n\nDetailed field-by-field comparison showed:\n\n45 out of 50 fields were identical across duplicates\nOnly 5 submission metadata fields differed: UniqSubmissionID, AuditId, MSD401_ID, RecordNumber, CareProfLIDDel\n99%+ of duplicates had identical clinical data\n\nConclusion: Duplicates represent multiple submissions of identical data, not different clinical events.\n\n\n2.2.3 Deduplication Strategy\nApplied consistent deduplication across all MSDS tables:\nROW_NUMBER() OVER (\n  PARTITION BY [natural_key]\n  ORDER BY UniqSubmissionID DESC  -- Most recent submission\n) AS rn\n\n-- Then filter: WHERE rn = 1\nThis approach: - Keeps the most recent submission for each unique entity - Preserves data integrity (clinical values are consistent) - Reduces dataset from 1.8M to 512k records (correct granularity)"
  },
  {
    "objectID": "index.html#ncc-data-source-comparison",
    "href": "index.html#ncc-data-source-comparison",
    "title": "Neonatal Critical Care Base Dataset: Construction and Descriptive Statistics",
    "section": "3.2 NCC Data Source Comparison",
    "text": "3.2 NCC Data Source Comparison\nWe compared NCC admission data from two sources to ensure data quality:\n\n\n\n\n\n\n\n\nFigure 4: Critical Care data captures significantly more NCC admissions than MSDS\n\n\n\n\n\n\n\n\n\n\n\nTipDecision: Use Critical Care as Primary Source\n\n\n\nCritical Care data captures 3.76x more NCC admissions than MSDS (due to contractual Payment by Results reporting requirements). The combined flag NCC_Admitted = 1 if baby appears in either source."
  },
  {
    "objectID": "index.html#overall-dataset-summary",
    "href": "index.html#overall-dataset-summary",
    "title": "Neonatal Critical Care Base Dataset: Construction and Descriptive Statistics",
    "section": "4.1 Overall Dataset Summary",
    "text": "4.1 Overall Dataset Summary\n\n\n\n\n\nMetric\nValue\n\n\n\n\nTotal births in 2023/24\n512,032\n\n\nNCC admissions (any source)\n64,109\n\n\nNCC admission rate\n12.52%\n\n\nBirths without NCC admission\n447,923\n\n\nNumber of variables in dataset\n59"
  },
  {
    "objectID": "index.html#baby-demographics",
    "href": "index.html#baby-demographics",
    "title": "Neonatal Critical Care Base Dataset: Construction and Descriptive Statistics",
    "section": "4.2 Baby Demographics",
    "text": "4.2 Baby Demographics\n\n4.2.1 Sex Distribution and NCC Rates\n\n\n\n\n\n\n\n\nFigure 5: NCC admission rates by baby’s sex\n\n\n\n\n\n\n\n4.2.2 Ethnicity Distribution\n\n\n\n\n\nEthnicity\nBirths\nNCC Admissions\nNCC Rate (%)\n\n\n\n\nWhite - British\n278,290\n37,076\n13.32\n\n\nWhite - Other\n52,301\n5,318\n10.17\n\n\nAsian - Pakistani\n26,160\n2,816\n10.76\n\n\nAsian - Indian\n25,287\n3,284\n12.99\n\n\nBlack - African\n24,819\n3,316\n13.36\n\n\nMixed - Other\n15,692\n1,847\n11.77\n\n\nAsian - Other\n14,851\n1,835\n12.36\n\n\nOther Ethnic Group\n12,699\n1,347\n10.61\n\n\nMissing\n12,430\n868\n6.98\n\n\nAsian - Bangladeshi\n8,796\n958\n10.89\n\n\nMixed - White & Asian\n8,009\n889\n11.10\n\n\nMixed - White & Black Caribbean\n6,667\n859\n12.88"
  },
  {
    "objectID": "index.html#clinical-characteristics",
    "href": "index.html#clinical-characteristics",
    "title": "Neonatal Critical Care Base Dataset: Construction and Descriptive Statistics",
    "section": "4.3 Clinical Characteristics",
    "text": "4.3 Clinical Characteristics\n\n4.3.1 Gestation Length\n\n\n\n\n\n\n\n\nFigure 6: Distribution of gestation length at birth\n\n\n\n\n\n\n\n4.3.2 Delivery Method\n\n\n\n\n\nDelivery Method\nBirths\n% of Total\nNCC Admissions\nNCC Rate (%)\n\n\n\n\nSpontaneous Vertex\n233,029\n45.5\n18,965\n8.14\n\n\nEmergency Caesarean\n120,835\n23.6\n26,660\n22.06\n\n\nElective Caesarean\n89,585\n17.5\n9,560\n10.67\n\n\nVentouse/Vacuum\n21,372\n4.2\n2,378\n11.13\n\n\nLow Forceps\n19,607\n3.8\n2,462\n12.56\n\n\nOther Forceps\n11,013\n2.2\n1,540\n13.98\n\n\nSpontaneous Other Cephalic\n7,164\n1.4\n684\n9.55\n\n\nMissing\n3,809\n0.7\n776\n20.37\n\n\nOther\n3,615\n0.7\n465\n12.86\n\n\nBreech\n1,675\n0.3\n516\n30.81\n\n\nBreech Extraction\n326\n0.1\n102\n31.29\n\n\nOther (N)\n2\n0.0\n1\n50.00"
  },
  {
    "objectID": "index.html#ncc-admission-characteristics",
    "href": "index.html#ncc-admission-characteristics",
    "title": "Neonatal Critical Care Base Dataset: Construction and Descriptive Statistics",
    "section": "4.4 NCC Admission Characteristics",
    "text": "4.4 NCC Admission Characteristics\n\n4.4.1 Time to NCC Admission\n\n\n\n\n\n\n\n\nFigure 7: Most babies are admitted to NCC within hours of birth\n\n\n\n\n\n\n\n4.4.2 NCC Length of Stay\n\n\n\n\n\n\n\n\nFigure 8: Distribution of NCC length of stay"
  },
  {
    "objectID": "index.html#maternal-demographics",
    "href": "index.html#maternal-demographics",
    "title": "Neonatal Critical Care Base Dataset: Construction and Descriptive Statistics",
    "section": "4.5 Maternal Demographics",
    "text": "4.5 Maternal Demographics\n\n4.5.1 Mother’s Ethnicity and NCC Rates\n\n\n\n\n\n\n\n\nFigure 9: NCC admission rates by mother’s ethnicity"
  },
  {
    "objectID": "index.html#social-factors-inequality-measures",
    "href": "index.html#social-factors-inequality-measures",
    "title": "Neonatal Critical Care Base Dataset: Construction and Descriptive Statistics",
    "section": "4.6 Social Factors (Inequality Measures)",
    "text": "4.6 Social Factors (Inequality Measures)\n\n\n\n\n\n\n\n\nFigure 10: NCC rates are higher for mothers with complex social factors"
  },
  {
    "objectID": "index.html#completeness-by-key-variable",
    "href": "index.html#completeness-by-key-variable",
    "title": "Neonatal Critical Care Base Dataset: Construction and Descriptive Statistics",
    "section": "5.1 Completeness by Key Variable",
    "text": "5.1 Completeness by Key Variable\n\n\n\n\n\nVariable\nComplete Records\nMissing Records\n% Complete\n\n\n\n\nNHS_Number_Baby\n512,032\n0\n100.00\n\n\nBaby_Birth_Date\n512,032\n0\n100.00\n\n\nBaby_Sex\n512,032\n0\n100.00\n\n\nEthnic_Category_Baby\n499,602\n12,430\n97.57\n\n\nGestation_Length_At_Birth\n512,032\n0\n100.00\n\n\nDelivery_Method_Code\n508,223\n3,809\n99.26\n\n\nEthnic_Category_Mother\n510,548\n1,484\n99.71\n\n\nNCC_Admitted\n512,032\n0\n100.00\n\n\nNCC_Hospital_Provider_Code\n59,458\n452,574\n11.61\n\n\nMother_CCG_Residence\n240,014\n272,018\n46.87"
  },
  {
    "objectID": "index.html#known-data-limitations",
    "href": "index.html#known-data-limitations",
    "title": "Neonatal Critical Care Base Dataset: Construction and Descriptive Statistics",
    "section": "5.2 Known Data Limitations",
    "text": "5.2 Known Data Limitations\n\n\n\n\n\n\nWarningData Gaps to Address\n\n\n\n\nBirth weight and Apgar scores: Not available in main table; requires additional linkage\nMother’s age: Date of birth not available; cannot calculate maternal age\nDeprivation (IMD): Requires LSOA-to-IMD linkage\nNCC source discrepancies: Only 17.4% overlap between data sources"
  },
  {
    "objectID": "index.html#database-connection",
    "href": "index.html#database-connection",
    "title": "Neonatal Critical Care Base Dataset: Construction and Descriptive Statistics",
    "section": "5.1 Database Connection",
    "text": "5.1 Database Connection\n\nPlatform: NHS UDAL (Unified Data Access Layer) on Azure Synapse Analytics\nAuthentication: Azure Active Directory Interactive\nAccess: Requires UDAL data access permissions"
  },
  {
    "objectID": "index.html#sql-query-structure",
    "href": "index.html#sql-query-structure",
    "title": "Neonatal Critical Care Base Dataset: Construction and Descriptive Statistics",
    "section": "5.2 SQL Query Structure",
    "text": "5.2 SQL Query Structure\nThe final query consists of several CTEs (Common Table Expressions):\n\nncc_from_cc: Aggregates daily CC records to baby-level\napcs_link: Provides NHS numbers for linkage\nncc_cc_with_nhs: Links CC data to NHS numbers\nmsds_babies_raw + msds_babies: Deduplicates baby demographics\nmsds_labour_raw + msds_labour: Deduplicates labour/delivery records\nmsds_mothers_raw + msds_mothers: Deduplicates mother demographics\nmsds_pregnancy_raw + msds_pregnancy: Deduplicates pregnancy/booking records\nmsds_neonatal_adm_raw + msds_neonatal_adm: Deduplicates neonatal admissions\nbase_dataset: Joins all deduplicated tables together"
  },
  {
    "objectID": "index.html#output",
    "href": "index.html#output",
    "title": "Neonatal Critical Care Base Dataset: Construction and Descriptive Statistics",
    "section": "5.3 Output",
    "text": "5.3 Output\n\nFormat: RDS (R Data Serialization)\nFilename: data/ncc_base_dataset.rds\nRecords: 512,032\nFields: 59\nGranularity: One record per baby born in hospital in 2023/24"
  },
  {
    "objectID": "index.html#for-hierarchical-modeling",
    "href": "index.html#for-hierarchical-modeling",
    "title": "Neonatal Critical Care Base Dataset: Construction and Descriptive Statistics",
    "section": "6.1 For Hierarchical Modeling",
    "text": "6.1 For Hierarchical Modeling\nThe dataset is now ready for hierarchical (mixed-effects) modeling to examine:\n\nFixed effects (patient characteristics):\n\nBaby: Sex, ethnicity, gestation, birth order\nMother: Ethnicity, social factors, employment, disability\nDelivery: Method, location\n\nRandom effects (hospital/provider variation):\n\nNCC_Hospital_Provider_Code: Where NCC care was provided\nDelivery_Site_Code: Where baby was born\nOrg_ID_Commissioner: Commissioning organization\n\nOutcome variables:\n\nBinary: NCC_Admitted (1/0)\nTime-to-event: Hours_Birth_To_NCC_CC (for survival/frailty models)"
  },
  {
    "objectID": "index.html#additional-data-enrichment-needed",
    "href": "index.html#additional-data-enrichment-needed",
    "title": "Neonatal Critical Care Base Dataset: Construction and Descriptive Statistics",
    "section": "6.2 Additional Data Enrichment Needed",
    "text": "6.2 Additional Data Enrichment Needed\n\nDeprivation indices: Link LSOA codes to IMD scores\nBirth weight and Apgar scores: Join MSD405CareActivityBaby_1 table\nGeography: Link to CCG/ICB boundaries and rural/urban classifications\nClinical severity measures: Additional neonatal clinical indicators if available"
  },
  {
    "objectID": "index.html#what-this-means",
    "href": "index.html#what-this-means",
    "title": "Neonatal Critical Care Base Dataset: Construction and Descriptive Statistics",
    "section": "",
    "text": "This analysis looks at which babies receive specialist neonatal critical care in England. We found that approximately 1 in 8 babies (12.5%) born in hospital require some form of neonatal critical care.\nThe data we’ve assembled will help us understand whether all babies have equal access to this care, regardless of their:\n\nEthnic background\nFamily’s socioeconomic circumstances\nWhere they live in England\nTheir mother’s social circumstances\n\nUnderstanding these patterns is the first step toward ensuring every baby gets the care they need, when they need it."
  },
  {
    "objectID": "index.html#data-quality-resolving-duplication",
    "href": "index.html#data-quality-resolving-duplication",
    "title": "Neonatal Critical Care Base Dataset: Construction and Descriptive Statistics",
    "section": "3.1 Data Quality: Resolving Duplication",
    "text": "3.1 Data Quality: Resolving Duplication\nA critical data quality issue was identified and resolved during dataset construction.\n\n\n\n\n\n\n\n\nFigure 3: MSDS tables contained significant duplication that required resolution\n\n\n\n\n\n\n\n\n\n\n\nImportantWhy This Matters\n\n\n\nWithout deduplication, the dataset would have contained ~1.8 million records instead of the correct ~540,000 births. This would have severely biased any analysis.\n\n\n\n\n\n\n\n\nNoteTechnical Details: Deduplication Strategy (click to expand)\n\n\n\n\n\nInvestigation revealed that 91.6% of babies had duplicate records, with some having up to 32 duplicates. However, 45 out of 50 fields were identical across duplicates - only submission metadata differed.\nConclusion: Duplicates represent multiple submissions of identical data, not different clinical events.\nSolution applied:\nROW_NUMBER() OVER (\n  PARTITION BY [natural_key]\n  ORDER BY UniqSubmissionID DESC  -- Most recent submission\n) AS rn\n\n-- Then filter: WHERE rn = 1"
  },
  {
    "objectID": "index.html#for-hierarchical-modelling",
    "href": "index.html#for-hierarchical-modelling",
    "title": "Neonatal Critical Care Base Dataset: Construction and Descriptive Statistics",
    "section": "7.1 For Hierarchical Modelling",
    "text": "7.1 For Hierarchical Modelling\nThe dataset is now ready for hierarchical (mixed-effects) modelling to examine:\n\nFixed effects (patient characteristics):\n\nBaby: Sex, ethnicity, gestation, birth order\nMother: Ethnicity, social factors, employment, disability\nDelivery: Method, location\n\nRandom effects (hospital/provider variation):\n\nNCC_Hospital_Provider_Code: Where NCC care was provided\nDelivery_Site_Code: Where baby was born\n\nOutcome variables:\n\nBinary: NCC_Admitted (1/0)\nTime-to-event: Hours_Birth_To_NCC_CC (for survival/frailty models)"
  }
]